<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Time Management Planner</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:system-ui, sans-serif;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  padding:20px;
  color:#fff;
}
.container{
  max-width:900px;
  margin:auto;
}
h1{
  text-align:center;
  margin-bottom:10px;
}
.card{
  background:rgba(255,255,255,0.12);
  backdrop-filter:blur(14px);
  border-radius:20px;
  padding:20px;
  box-shadow:0 20px 40px rgba(0,0,0,.4);
  margin-bottom:20px;
}
input,button{
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:12px;
  border:none;
  outline:none;
}
input{
  background:#fff;
  color:#111;
}
button{
  background:#22c55e;
  color:#fff;
  font-size:16px;
  cursor:pointer;
}
button:hover{
  background:#16a34a;
}
.task{
  background:#fff;
  color:#111;
  border-radius:14px;
  padding:14px;
  margin-bottom:10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.task.done{
  background:#dcfce7;
  text-decoration:line-through;
}
.progress{
  height:18px;
  background:#e5e7eb;
  border-radius:20px;
  overflow:hidden;
  margin-top:10px;
}
.fill{
  height:100%;
  background:#22c55e;
  width:0%;
}
small{
  opacity:.85;
}

input,
textarea,
select {
  color: #0f172a;   /* FORCE visible text */
  background: #fff;
}
.bot-message .bubble {
  color: #0f172a !important;
  font-size: 0.95rem;
  line-height: 1.4;
}
/* üî• FIX CHAT INPUT BAR ISSUE */
#chatPopup button {
  width: auto !important;
  margin-top: 0 !important;
  padding: 10px 18px;
  flex-shrink: 0;
}

#chatPopup input {
  margin-top: 0 !important;
}
</style>
</head>

<body>
<div class="container">
<h1>‚è±Ô∏è Smart Day Planner</h1>
<p style="text-align:center;opacity:.85">Plan your day. Track your focus.</p>

<!-- ADD TASK -->
<div class="card">
  <h2>Add Task</h2>
  <input id="taskName" placeholder="Task name (e.g. DSA practice)">
  <input id="taskTime" type="number" placeholder="Estimated time (minutes)">
  <button onclick="addTask()">Add Task</button>
</div>

<!-- TASK LIST -->
<div class="card">
  <h2>Today's Tasks</h2>
  <div id="taskList"></div>

  <small>Productivity</small>
  <div class="progress">
    <div id="progressBar" class="fill"></div>
  </div>
  <p id="percent">0% completed</p>
</div>
</div>
 <!-- FLOATING CHAT BOT ICON -->
<button id="chatToggle" style="
position:fixed;
bottom:20px;
right:20px;
z-index:999;
width:60px;
height:60px;
border-radius:50%;
border:none;
background:linear-gradient(135deg,#667eea,#764ba2);
color:white;
font-size:26px;
cursor:pointer;
box-shadow:0 8px 20px rgba(0,0,0,0.3);
"> üí¨ </button>

<!-- CHAT BOT POPUP -->
<div id="chatPopup" style="
display:none;
position:fixed;
bottom:90px;
right:20px;
z-index:999;
width:560px;
height:630px;
background:#fff;
border-radius:20px;
box-shadow:0 10px 40px rgba(0,0,0,0.3);
overflow:hidden;
display:flex;
flex-direction:column;
">



  <div style="
background:linear-gradient(135deg,#667eea,#764ba2);
color:white;
padding:14px;
text-align:center;
font-weight:600;
"> ‚ú® Chat Assistant </div>

  <div id="messages" style="
flex:1;
overflow-y:auto;
padding:12px;
background:#f8f9fa;
"></div>

  <div style="
display:flex;
align-items:center;
padding:10px;
border-top:1px solid #351fa4;
gap:10px;
background:#fff;
">

   <input id="userInput" placeholder="Type or speak..." style="flex:1;padding:10px;border-radius:20px;border:1px solid #ccc;outline:none;" onkeypress="handleKeyPress(event)">

<button id="sendBtn" onclick="sendMessage()" style="padding:10px 16px;border:none;border-radius:20px;background:#667eea;color:white;"> Send </button>


  </div>

</div>

<script>
let tasks = JSON.parse(localStorage.getItem("tasks")) || [];

function addTask(){
  const name=document.getElementById("taskName").value;
  const time=document.getElementById("taskTime").value;
  if(!name||!time) return alert("Fill all fields");

  tasks.push({name,time,done:false});
  save();
}

function toggleTask(i){
  tasks[i].done=!tasks[i].done;
  save();
}

function save(){
  localStorage.setItem("tasks",JSON.stringify(tasks));
  render();
}

function render(){
  const list=document.getElementById("taskList");
  list.innerHTML="";

  let total=0,done=0;

  tasks.forEach((t,i)=>{
    total+=Number(t.time);
    if(t.done) done+=Number(t.time);

    const div=document.createElement("div");
    div.className="task"+(t.done?" done":"");
    div.innerHTML=`
      <div>
        <strong>${t.name}</strong><br>
        <small>${t.time} min</small>
      </div>
      <input type="checkbox" ${t.done?"checked":""} onchange="toggleTask(${i})">
    `;
    list.appendChild(div);
  });

  const percent = total ? Math.round(done/total*100) : 0;
  document.getElementById("progressBar").style.width=percent+"%";
  document.getElementById("percent").innerText=percent+"% completed";
}

render();

 const API_KEY = "AIzaSyByxO6K_Mqlfb2R5_b4NKquz9q_-2W4o1E";     //ENTER YOUR API KEY

const chatToggle = document.getElementById("chatToggle");
const chatPopup  = document.getElementById("chatPopup");
const messages   = document.getElementById("messages");

chatToggle.onclick = () => {
  chatPopup.style.display =
    chatPopup.style.display === "none" ? "flex" : "none";
};

function handleKeyPress(e){
  if(e.key==="Enter") sendMessage();
}

async function sendMessage(){
  const input=document.getElementById("userInput");
  const btn=document.getElementById("sendBtn");
  if(!input.value.trim()) return;

  addMsg(input.value,"user");
  const text=input.value;
  input.value = "";
input.focus();
btn.disabled = true;


  const typing=document.createElement("div");
  typing.className="bot-message";
  typing.innerHTML=`<div class="bubble typing">
    <span></span><span></span><span></span>
  </div>`;
  messages.appendChild(typing);
  messages.scrollTop=messages.scrollHeight;

  try{
    const res=await fetch(
      `https://generativelanguage.googleapis.com/v1/models/gemini-2.5-flash:generateContent?key=${API_KEY}`,
      {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body:JSON.stringify({
          contents:[{ parts:[{ text:text }] }]
        })
      }
    );
    const data=await res.json();
    typing.remove();
    addMsg(data.candidates[0].content.parts[0].text,"bot");
  }catch{
    typing.remove();
    addMsg("Network error ‚ùå","bot");
  }finally{
    btn.disabled=false;
  }
}

function addMsg(text,type){
  const div=document.createElement("div");
  div.className=`message ${type}-message`;
  div.innerHTML=`<div class="bubble">${escapeHtml(text)}</div>`;
  messages.appendChild(div);
  messages.scrollTop=messages.scrollHeight;
}

function escapeHtml(t){
  const d=document.createElement("div");
  d.textContent=t;
  return d.innerHTML;
}

const userInput = document.getElementById("userInput");
const sendBtn   = document.getElementById("sendBtn");

/* ENTER KEY FIX */
userInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter" && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
});

/* BUTTON CLICK */
sendBtn.addEventListener("click", sendMessage);


</script>
</body>
</html>

